@page "/register"
@inject AuthService AuthService
@inject NavigationManager Navigation

<MudText Typo="Typo.h5" Class="mb-2">Регистрация</MudText>

<MudTextField @bind-Value="email" Label="Email" Class="mb-2" />
<MudTextField @bind-Value="password" Label="Парола" InputType="InputType.Password" Class="mb-2" />
<MudTextField @bind-Value="confirmPassword" Label="Повтори паролата" InputType="InputType.Password" Class="mb-2" />

<MudButton Color="Color.Primary" OnClick="Register">Регистрация</MudButton>

<MudText Color="Color.Error">@errorMessage</MudText>

@code {
    private string email;
    private string password;
    private string confirmPassword;
    private string errorMessage;

    private async Task Register()
    {
        errorMessage = "";

        if (password != confirmPassword)
        {
            errorMessage = "Паролите не съвпадат!";
            return;
        }

        var success = await AuthService.Register(email, password);
        if (success)
        {
            Navigation.NavigateTo("/login");
        }
        else
        {
            errorMessage = "Грешка при регистрацията. Моля, опитайте отново.";
        }
    }
}
